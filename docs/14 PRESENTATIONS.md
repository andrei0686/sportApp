# Функциональные предствление

![diagrams](diagrams/functions.svg)

## Администрирование и аналитика
Используются роли Аналитик, Маркетолог, Администратор.

Аналитик формирует отчеты на основе данных пользователей.

Маркетолог может формировать маркетинговые компании с основными сущностями Кампания, Целевая аудитория, Отчет об эффективности.

Администратор занимается модерацией контента, при появлении жалобы проводит проверку и принимает решение на блокировку или удаление аккаунта.

Администратор проводит обновление функционала системы который был разработан на основе обратной связи от пользователей и аналитики.

## События и турниры
Этот модуль позволяет федерациям, спортивным организациям, тренерам и пользователям создавать, продвигать и управлять спортивными событиями, от локальных забегов до крупных онлайн-турниров.
### Ключевые сущности
Event: Основная сущность. Содержит все данные о событии.

Organizer: Может быть Федерацией, Тренер или Пользователь.

Registration: Связывает User и Event, хранит статус, дополнительные данные, результат.

Event Category: Категория для классификации событий.

Leaderboard Entry: Запись в таблице лидеров, связывает Registration с результатом (время, очки, место).

### функциональные блоки  
#### Создание и управление событиями
Центр управления для организаторов (федераций, тренеров).

CRUD для событий: Создание, просмотр, редактирование, удаление/архивация события.

Основные данные: 
* Название, описание, обложка, тип события (турнир, марафон, онлайн-заезд и т.д.).
* Дата и время (начало, окончание, регистрации), местоположение (с картой, адресом) или отметка Онлайн.
* Целевая аудитория (пол, возрастные группы, уровень подготовки), требования (наличие медицинской справки, специальный инвентарь).
* Правила, система начисления очков, критерии победы.
* Расписание этапов/активностей в рамках события.
* Описание призового фонда, наград.
* Статусы события: Черновик, Опубликовано, Регистрация открыта, Идет, Завершено, Отменено.
* Управление видимостью: Публичное событие или по ссылке (приватное).

####  Event Discovery
Помочь пользователям найти интересующие их события.

* Каталог событий: Список всех активных событий с фильтрами и сортировкой (по дате, популярности, типу, местоположению, онлайн/офлайн).
* Поиск по названию, описанию, организатору.
* Система предлагает события на основе интересов пользователя, его местоположения и прошлой активности.
* Структуризация событий по категориям (например, "Бег", "Йога", "Для начинающих", "Челлендж").
* Лента/анонсы: Закрепленные или рекомендованные события на главной странице.

####  Процесс регистрации 
Обеспечивает процесс записи пользователя на событие.

* Регистрация: Пользователь нажимает "Участвовать", система проверяет соответствие требованиям.
* Сбор дополнительных данных: Форма для заполнения необходимой информации (никнейм для турнира, весовая категория, размер футболки, номер телефона для экстренной связи).
* Загрузка документов: Возможность загрузить скан медицинской справки или иного требуемого документа (для проверки организатором).
* Интеграция с платежным шлюзом для оплаты взноса если событие платное. Выдача электронного билета.
* Если достигнут лимит участников, автоматическое включение в лист ожидания, с уведомлением о наличии свободного места.

####  Управление участниками 
Инструменты для организатора по работе с заявками.

* Панель управления событием: Просмотр списка всех участников, их статусов (зарегистрирован, оплатил, подтвержден, завершил).
* Верификация заявок: Ручное подтверждение участников, проверка загруженных документов.
* Добавление/удаление участников, изменение их статуса (например, снятие с турнира).
* Выгрузка данных участников (имена, контакты) в CSV/Excel.

####  Коммуникация и уведомления
Информирование участников и организатора.

Центр уведомлений для события:
* Организатору: Уведомления о новых заявках, вопросах от участников.
* Участникам: Автоматические уведомления (push, email) о старте регистрации, подтверждении заявки, напоминание о начале события, изменениях в программе, результатах.
* Встроенный чат/форум события: Место для общения участников между собой и с организатором, задавания вопросов.

####  Проведение и отслеживание результатов 
Финальная стадия — проведение события и подведение итогов.

* Для онлайн-событий: Интеграция с модулем онлайн-тренировок для проведения трансляции.
* Управление результатами:
* Автоматическое: Для событий, связанных с активностями в приложении (например, забег с трекингом через GPS). Результаты (время, дистанция) автоматически загружаются в таблицу лидеров.
* Ручное: Организатор вручную вводит или загружает итоговые результаты (например, по итогам судейства).
* Таблица лидеров (Leaderboard): Динамическое отображение результатов участников в реальном времени или после завершения.
* Объявление победителей, размещение финальных результатов и фотографий с события.

#### Профиль пользователя и история 
Отображение активности пользователя в событиях.

* Вкладка "Мои события": В профиле пользователя отображаются: "Предстоящие", "Текущие", "Завершенные" события.
* Награды и значки, полученные за участие и победы в событиях, добавляются в коллекцию пользователя.
* Для завершенных событий отображаются результат пользователя (его место, время и т.д.) и ссылка на общие итоги.

## Питание и здоровье
Включает сущности Дневник питания, Продукт, Рецепт, Рекомендация по питанию.

Может создаваться как Тренером, так и пользователем.

## Аккаунт и данные
Этот модуль отвечает за идентификацию пользователя, управление его профилем, безопасность доступа и централизованное хранение всех персональных данных, которые используются другими модулями системы.

### Функциональные блоки (подмодули)
### 1.1. Аутентификация (Authentication)
Назначение: Убедиться, что пользователь тот, за кого себя выдает.

Функции:

Классическая регистрация по email/паролю: Валидация email, проверка сложности пароля, хеширование пароля (bcrypt).

OAuth 2.0 авторизация: Интеграция с провайдерами (Google, Apple, VK, Yandex, Facebook). Получение и обработка данных профиля.

Вход (Login): Проверка учетных данных, создание сессии.

Выход (Logout): Завершение сессии на стороне сервера.

Восстановление доступа: Процедура "Забыли пароль?" через отправку ссылки на email.

### 1.2. Верификация и безопасность (Verification & Security)
Назначение: Повышение уровня доверия и безопасности аккаунта.

Функции:

Подтверждение email: Отправка welcome-письма со ссылкой для подтверждения.

Верификация номера телефона (SMS):

Отправка одноразового кода (OTP) через SMS-шлюз (например, SMS.ru, Twilio).

Проверка введенного кода.

Логика повторной отправки кода (с задержкой для предотвращения спама).

Управление сессиями: Просмотр активных устройств/сессий, возможность удалить конкретную сессию.

Двухфакторная аутентификация (2FA): (Опционально) Настройка через TOTP-приложение (Google Authenticator).

### 1.3. Управление профилем (Profile Management)
Назначение: Централизованное хранение и управление персональными данными пользователя.

Функции:

CRUD основных данных: Имя, фамилия, никнейм, пол, дата рождения, город, часовой пояс, "О себе".

Управление аватаром: Загрузка, обрезка, удаление фотографии профиля.

Спортивный профиль:

Антропометрия: Рост, вес, ИМТ (авторасчет).

Цели: Цель тренировок (похудение, набор массы, поддержание формы, подготовка к мероприятию).

Уровень подготовки: Начинающий, любитель, профессионал.

Интересы и предпочтения: Любимые виды активности (бег, йога, плавание) для персонализации ленты и рекомендаций.

Медицинские противопоказания/травмы: Важная информация для формирования безопасных тренировочных планов.

### 1.4. Интеграция с носимими устройствами и API (Wearables & API Integration)
Назначение: Автоматический сбор данных о физической активности для более точного анализа.

Функции:

Поддержка основных провайдеров: Интеграция с Apple HealthKit, Google Fit, Strava, Garmin, Fitbit.

Процесс подключения: OAuth-аутентификация на стороне провайдера, запрос разрешений на доступ к данным.

Синхронизация данных: Фоновая периодическая или ручная выгрузка данных:

Типы данных: Шаги, дистанция, калории, пульс (в состоянии покоя и во время активности), сон, вес.

Управление подключениями: Просмотр подключенных сервисов, отзыв доступа.

### 1.5. Управление данными и конфиденциальность (Data & Privacy)
Назначение: Соответствие GDPR и другим регуляториям, предоставление пользователям контроля над их данными.

Функции:

Экспорт данных: Возможность запроса и скачивания архива со всеми персональными данми в машиночитаемом формате (JSON, CSV).

Удаление аккаунта: Функция полного "права на забвение". Все данные пользователя анонимизируются или полностью удаляются из системы.

Настройки конфиденциальности: Управление видимостью профиля (публичный/приватный), активности, результатов.

### 1.6. Система уведомлений (Preferences & Notifications)
Назначение: Центр управления уведомлениями, чтобы пользователь получал только релевантную информацию.

Функции:

Каналы уведомлений: Push-уведомления, Email, SMS.

Гибкие настройки: Возможность включить/отключить уведомления для разных событий:

Новые сообщения от тренера.

Напоминания о тренировках.

Комментарии в сообществах.

Рекламные рассылки и новости.

Уведомления о мероприятиях.

### Ключевые сущности (Entities)
User (Пользователь): Основная сущность. Хранит логин, хеш пароля, статус аккаунта (active, pending, blocked).

Profile (Профиль): Связана с User. Содержит все персональные, спортивные и настройки данные.

AuthSession (Сессия): Хранит токены (JWT или иные) для управления сессиями.

OAuthConnection (OAuth-подключение): Хранит идентификатор пользователя у стороннего провайдера (например, google_id) и токен доступа.

Device (Устройство): Информация об устройстве (модель, OS) для управления push-токенами и сессиями.

UserMetric (Метрика пользователя): Исторические данные антропометрии (вес, рост) и здоровья (пульс покоя), привязанные к дате для построения графиков.


## тренер и услуги
### Управление расписанием тренера
Тренер создает Слот, указывает Формат
### Проведение онлайн-тренировки
Тренер запускает Трансляцию, привязанную к Слоту. 
Пользователи присоединяются, используется Чат. 
Факт проведения фиксируется как завершенная Тренировка.
### Верификация тренера
Заявка на верификацию с прикрепленными Документами. 
Федерация меняет Статус верификации тренера.

### Запись тренировки
Ручной ввод или импорт данных (API Google Fit, Apple HealthKit).

## Тренер и услуги
Этот модуль предоставляет тренерам и спортивным экспертам инструменты для ведения клиентской базы, создания и продажи услуг, а пользователям — удобный способ найти эксперта и получить персональное руководство.
### Функциональные блоки (подмодули)
### 1.1. Статус тренера и верификация (Coach Profile & Verification)
Назначение: Отделить сертифицированных специалистов от обычных пользователей и повысить доверие.

Функции:

Заявка на получение статуса "Тренер": Пользователь подает заявку в своем профиле.

Загрузка подтверждающих документов: Сертификаты, дипломы, портфолио, страховка.

Модерация со стороны федерации/администрации: Проверка документов, одобрение или отклонение заявки с указанием причины.

Публичный профиль тренера: Отдельная страница с био, специализацией, регалиями, отзывами, рейтингом и статусом верификации ("Проверен Федерацией").

Поиск и каталог тренеров: Фильтры по специализации (силовые, бег, йога), рейтингу, цене, формату (онлайн/офлайн).

### 1.2. Управление расписанием (Schedule Management)
Назначение: Позволить тренеру эффективно управлять своим временем, а клиентам — легко записываться.

Функции:

"Календарь" тренера: Инструмент для визуального планирования.

Создание слотов: Тренер указывает доступные интервалы времени для занятий.

Настройка типа сессии: Для каждого слота можно указать:

Формат: Индивидуальная тренировка, групповая (с указанием макс. количества человек), онлайн-трансляция.

Продолжительность (30/60/90 мин).

Стоимость (за занятие или пакет).

Местоположение (спортивный зал, Zoom-ссылка, адрес).

Автоматическое блокирование времени: После записи клиента слот помечается как "занят".

Интеграция с календарями: Синхронизация с Google Calendar/Apple Calendar.

### 1.3. Система бронирования и оплаты (Booking & Payment System)
Назначение: Автоматизировать процесс продажи услуг.

Функции:

Просмотр доступных слотов: Клиент видит в профиле тренера его свободное время.

Процесс записи: Выбор слота, подтверждение, оплата.

Интеграция с платежными шлюзами (Stripe, ЮKassa, Tinkoff): Безопасное проведение платежей.

Управление бронированиями:

Для тренера: Просмотр всех предстоящих и завершенных сессий.

Для клиента: Просмотр своих записей в личном кабинете.

Уведомления: Напоминание тренеру и клиенту о предстоящей тренировке (за 24 часа, за 1 час).

Политика отмены: Возможность настройки правил (например, бесплатная отмена за 24 часа).

### 1.4. Персональные тренировочные планы (Personal Training Plans)
Назначение: Основная услуга, ради которой пользователи ищут тренера.

Функции:

Система запросов: Пользователь отправляет официальный запрос тренеру, указывая цели, сроки, бюджет, ограничения.

Конструктор планов: Визуальный инструмент для тренера с библиотекой упражнений (с видео и описанием техники).

Структура плана: Возможность создать программу на неделю/месяц с расписанием, подходами, повторениями, отдыхом, RPE (оценка воспринимаемой нагрузки).

Прикрепление материалов: Добавление видеоинструкций, заметок, рекомендаций по питанию.

Назначение плана клиенту: Готовый план появляется в разделе "Мои планы" у пользователя.

### 1.5. Обратная связь и отчетность (Feedback & Reporting)
Назначение: Контроль за выполнением плана и корректировка программ.

Функции:

Система отправки отчетов: Клиент прикрепляет к выполненной тренировке фото, видео, текстовые заметки ("что болело", "какие ощущения").

Лента активности клиента: Тренер в своем интерфейсе видит ход выполнения плана, завершенные тренировки и присланные отчеты.

Инструменты для обратной связи: Тренер может оставлять текстовые и голосовые комментарии, рисовать пометки на видео клиента для коррекции техники.

Чат с клиентом: Персональный защифрованный канал для обсуждения прогресса и вопросов.

### 1.6. Проведение онлайн-тренировок (Live Online Coaching)
Назначение: Проведение занятий в реальном времени для индивидуальных клиентов и групп.

Функции:

Создание виртуальной "комнаты": Автоматическое создание конференции (через интеграцию с Zoom, Whereby или кастомное WebRTC-решение) в назначенное время.

Доступ для клиентов: Участники, записавшиеся на занятие, получают ссылку для входа.

Встроенный чат и аудиосвязь: Для общения во время тренировки.

Запись сессии: Возможность записи тренировки для ее последующего просмотра клиентами.

Автоматическое сохранение результата: Факт проведения онлайн-тренировки фиксируется в истории занятий клиента.

### 1.7. Управление клиентской базой (Client Management - CRM)
Назначение: Помочь тренеру систематизировать работу с клиентами.

Функции:

База клиентов: Список всех текущих и прошлых клиентов.

История взаимодействий: Все тренировки, планы, сообщения и платежи по каждому клиенту в одном месте.

Заметки тренера: Приватные заметки о клиенте ("боится приседаний", "цель - марафон через 6 мес.").

Напоминания: Оповещения тренера о необходимости продлить план или провести check-in с клиентом.

### Ключевые сущности (Entities)
Coach (Тренер): Расширенная сущность User. Содержит ссылку на VerificationRequest, рейтинг, специализацию, описание услуг.

VerificationRequest (Заявка на верификацию): Статус, attached документы, комментарий модератора.

TrainingSlot (Слот для тренировки): Время, продолжительность, формат, цена, статус (свободен/занят).

Booking (Бронирование): Связывает User (клиента), Coach и TrainingSlot. Содержит статус оплаты.

TrainingPlan (План тренировок): Создан тренером, назначен на пользователя. Содержит массив WorkoutPlan.

CoachClientRelationship (Связь тренер-клиент): Устанавливается после первого бронирования или назначения плана. Нужна для разграничения доступа к данным.

## Инвентарь и Рекомендации" (Inventory & Recommendations Module)
Этот модуль помогает пользователям систематизировать свою спортивную экипировку, следить за ее состоянием и получать умные рекомендации по замене или покупке нового инвентаря, основанные на их активности и износе текущих вещей.

### Функциональные блоки (подмодули)
#### 1.1. Каталог и управление инвентарем (Inventory Catalog & Management)
Назначение: Единое место для учета всей спортивной экипировки пользователя.

Функции:

Добавление позиции: Ручной ввод или сканирование штрихкода (с последующей подгрузкой данных из партнерской базы).

Расширенная карточка инвентаря:

Основные данные: Название, бренд, модель, категория (обувь, одежда, аксессуары, снаряжение), фото.

Атрибуты: Дата покупки, начальный пробег/счетчик (если применимо), стоимость, гарантийный срок.

Произвольные поля: Цвет, размер, материал и другие характеристики.

Категоризация: Возможность создавать свои коллекции ("Для бега", "Для зала", "Летнее").

CRUD операции: Редактирование, архивация или удаление позиций.

#### 1.2. Треккинг использования и износа (Usage & Wear Tracking)
Назначение: Автоматическое и ручное отслежиение эксплуатации инвентаря для расчета его износа.

Функции:

Ручное логирование: Пользователь после тренировки может указать, в какой экипировке он занимался (например, выбрать кроссовки из своего каталога).

Автоматическая привязка: Система может автоматически предлагать привязать инвентарь к активности на основе ее типа (например, кроссовки для бега — к пробежке).

Сбор метрик:

Для беговой обуви: Привязка километража из данных тренировки.

Для снаряжения: Количество тренировок или часов использования.

Общее: Учет стирок, общее время носки.

Визуализация износа: Прогресс-бар или график, показывающий, насколько исчерпан ресурс вещи.

#### 1.3. Система уведомлений о замене (Replacement Alerts)
Назначение: Своевременно информировать пользователя о необходимости обслуживания или замены экипировки.

Функции:

Настраиваемые пороги срабатывания: Пользователь или система устанавливает лимиты (например, 500 км для кроссовок, 50 стирок для мембранной куртки).

Умные уведомления: Push-уведомление или email с текстом: "Ваши кроссовки Nike Air Zoom достигли пробега 480 км. Рекомендуем присмотреться к замене".

Статусы инвентаря: В карточке отображается статус (Новый, В использовании, Требует внимания, На замену).

#### 1.4. Персонализированные рекомендации (Personalized Recommendations)
Назначение: Предлагать релевантные товары на основе поведения и потребностей пользователя.

Функции:

Рекомендации на основе износа: Если система видит, что кроссовки почти "убиты", она предлагает модели из партнерского магазина.

Рекомендации на основе активности: Анализ тренировок пользователя. Пример: пользователь начал больше бегать по пересеченной местности -> рекомендация трейловых кроссовок.

Рекомендации на основе сезона/геолокации: Предложения сезонной экипировки (зимой — термобелье, летом — бутылка для воды).

Алгоритмы машинного обучения: Построение рекомендаций по принципу "пользователям, похожим на вас, также понравилось...".

#### 1.5. Интеграция с партнерским маркетплейсом (Partner Marketplace Integration)
Назначение: Превратить рекомендацию в возможность покупки, не покидая приложение.

Функции:

Каталог товаров партнеров: API-интеграция с маркетплейсами (например, Яндекс.Маркет, Wildberries) или отдельными брендами.

Персональные скидки: Генерация промокодов для пользователя на рекомендуемые товары для повышения конверсии.

Глубокие ссылки (Deep Links): Переход по клику на карточку товара в приложении партнера или на его сайт (с отслеживанием перехода для атрибуции).

История покупок: Отслеживание покупок, совершенных через рекомендации (через партнерские ссылки).

#### 1.6. Отзывы и оценка инвентаря (Reviews & Feedback)
Назначение: Создать социальный proof и улучшить алгоритмы рекомендаций.

Функции:

Возможность оставить отзыв: Пользователь может оценить инвентарь из своего каталога, написать текст, поставить оценку.

Публичный каталог отзывов: Анонимизированные отзывы других пользователей приложения на те же модели товаров.

Влияние на рекомендации: Положительный отзыв на конкретную модель укрепляет ее позиции в рекомендациях для других.

### Ключевые сущности (Entities)
GearItem (Единица инвентаря): Основная сущность. Принадлежит User. Содержит все его атрибуты.

GearCategory (Категория инвентаря): Обувь, верхняя одежда, аксессуары, снаряжение и т.д. Нужна для классификации.

UsageLog (Лог использования): Связывает GearItem с Workout (тренировкой). Содержит метрики использования (километраж, время).

WearableThreshold (Порог износа): Задает правило для конкретного GearItem или GearCategory (макс. пробег, макс. кол-во использований).

Recommendation (Рекомендация): Содержит тип рекомендации (на замену, для новой активности), ссылку на товар у партнера, промокод.

PartnerProduct (Товар партнера): Кэшированные данные из внешнего API (название, бренд, цена, ссылка, картинка).

## Социальное взаимодействие
Социальное взаимодействие" (Social & Community Module)
Этот модуль отвечает за создание и поддержание социальных связей между пользователями, формирование сообществ по интересам и добавление элементов геймификации для повышения вовлеченности и мотивации.

Функциональные блоки (подмодули)
#### 1.1. Профиль и соц. присутствие (Social Profile & Presence)
Назначение: Создать публичную визитную карточку пользователя для социального взаимодействия.

Функции:

Публичная статистика: Возможность выбрать, какой прогресс показывать другим (беговой километраж, количество тренировок, достижения).

Лента активности: Автоматическая публикация завершенных тренировок (с возможностью настроить приватность: "всем", "друзьям", "только мне").

Аchievements и значки: Отображение заработанных наград в профиле.

Статус "онлайн" / "на тренировке": Индикация активности для друзей.

#### 1.2. Система друзей и подписок (Friends & Followers System)
Назначение: Построение личной социальной сети внутри приложения.

Функции:

Поиск людей: По имени, никнейму, или через импорт контактов.

Отправка запросов на дружбу: Пользователь должен подтвердить запрос.

Модель подписок: Можно не добавлять в друзья, а просто подписаться на интересного пользователя или тренера, чтобы видеть его активность.

Списки друзей: Возможность создавать группы (например, "Бегуны", "Команда по волеболу").

Взаимность: Разделение понятий "друзья" (взаимная связь) и "подписчики" (односторонняя).

#### 1.3. Группы и сообщества (Groups & Communities)
Назначение: Объединение пользователей вокруг тем, видов спорта, локаций или команд.

Функции:

Создание групп: Любой пользователь может создать публичную или приватную группу, установить правила, описание и аватар.

Поиск и каталог групп: Фильтрация по тематике, количеству участников, активности.

Модерация: Назначение модераторов, удаление участников, модерирование контента.

Приватные группы: Вступление по приглашению или одобрению администратора.

Лента группы: Отображение постов и активности участников в хронологическом порядке.

#### 1.4. Коммуникации: Лента, чаты, комментарии (Communication: Feed, Chat, Comments)
Назначение: Обеспечить все необходимые каналы для общения.

Функции:

Персональная лента новостей: Агрегация активности друзей, групп, на которые подписан пользователь, и рекомендованного контента.

Комментирование: Возможность комментировать тренировки, достижения и посты других пользователей.

Прямые сообщения (Direct Messaging): Личный и групповой чат между пользователями. Возможность отправки текста, фото, голосовых сообщений.

Чат внутри групп: Общий канал для общения всех участников сообщества.

Система упоминаний (@никнейм) и уведомлений о новых сообщениях.

#### 1.5. Совместные активности и челленджи (Shared Activities & Challenges)
Назначение: Добавить соревновательный элемент и возможность совместного досуга.

Функции:

Создание челленджей: Пользователи или бренды могут создавать соревнования (например, "Пробежать 100 км за месяц", "Первые 10 подтягиваний").

Участие в челленджах: Вступление, отслеживание своего прогресса и прогресса других участников в реальном времени.

Таблицы лидеров (Leaderboards): Рейтинги на основе различных метрик (километраж, количество тренировок, сожженные калории).

Приглашение на совместную тренировку: Отправка друзьям предложения совместной активности (онлайн или офлайн).

Виртуальные партнеры: Отображение на карте прогресса друга во время бега (если он открыл доступ).

#### 1.6. Мотивация и геймификация (Gamification)
Назначение: Повысить удержание и вовлеченность через игровые механики.

Функции:

Система достижений (Achievements): Значки и трофеи за различные milestones (первая тренировка, 100-й км, 5:00 утра на пробежке).

Стрики (Streaks): Отслеживание последовательных дней тренировок.

Рейтинги и уровни: Начисление очков опыта (XP) за активность, что повышает "уровень" пользователя.

Виртуальные награды и поздравления: Анимации и похвала за достижение целей.

#### 1.7. Модерация и безопасность (Moderation & Safety)
Назначение: Обеспечить здоровую и дружелюбную атмосферу в сообществе.

Функции:

Жалобы и репорты: Кнопка "Пожаловаться" на пост, комментарий или пользователя.

Автомодерация: Автоматическая фильтрация комментариев с использованием черного списка запрещенных слов.

Приватность и блокировка: Возможность заблокировать пользователя, ограничить видимость профиля.

Ручная модерация: Работа команды модераторов или администраторов групп по обработке жалоб.

### 2. Ключевые сущности (Entities)
User (Пользователь): Дополняется полями is_public, bio, social_links.

Friendship (Дружба): Связь между двумя пользователями с статусом (запрошено, принято, отклонено).

Group (Группа): Название, описание, аватар, тип (публичная/приватная), владелец.

GroupMembership (Участник группы): Связь User и Group с ролью (участник, модератор, администратор).

Post (Публикация): Контент (текст, фото, видео), автор, лайки, комментарии. Может быть привязана к Training.

Comment (Комментарий): Текст, автор, родительский пост/тренировка.

Challenge (Челлендж): Название, описание, цель (км, минуты, тренировки), длительность, тип (индивидуальный/групповой).

Participation (Участие): Связь User и Challenge для отслеживания прогресса.

## внешние системы
Этот модуль представляет собой набор шлюзов, адаптеров и API, которые обеспечивают обмен данными между ядром приложения и сторонними сервисами. Его ключевая задача — быть надежным и безопасным посредником.

### 1. Функциональные блоки (подмодули)
#### 1.1. Шлюз аутентификации и авторизации (Auth Gateway)
Назначение: Делегировать процесс входа и регистрации проверенным провайдерам, повышая безопасность и удобство.

Функции:

OAuth 2.0 / OpenID Connect интеграция: Поддержка протоколов для работы с Google, Apple, VK, Yandex, Facebook и другими провайдерами.

Единый вход (Single Sign-On - SSO): Позволяет пользователям использовать существующие учетные записи для быстрого входа.

Управление токенами: Безопасное получение, хранение и обновление access/refresh токенов от внешних провайдеров.

Сопоставление данных: Преобразование профиля пользователя из формата провайдера (например, Google Profile) во внутреннюю структуру данных приложения.

#### 1.2. Адаптер носимых устройств и трекеров (Wearables & Trackers Adapter)
Назначение: Автоматически импортировать данные о физической активности пользователя из различных источников.

Функции:

Поддержка множества API: Интеграция с Apple HealthKit, Google Fit, Strava, Garmin, Fitbit, Samsung Health.

Унификация данных: Преобразование сырых данных из разных API в единый внутренний формат приложения (например, приведение всех типов активности к стандартным, конвертация единиц измерения).

Фоновая синхронизация: Периодический опрос API провайдеров для обновления данных о шагах, пульсе, сне, калориях.

Обработка квот и лимитов: Корректная работа с ограничениями на количество запросов к внешним API.

#### 1.3. Платежный шлюз (Payment Gateway)
Назначение: Безопасная обработка финансовых транзакций внутри приложения без хранения чувствительных данных.

Функции:

Абстракция провайдеров: Единый интерфейс для работы с разными платежными системами (ЮKassa, Tinkoff, Stripe, Apple Pay, Google Pay).

Создание и проведение платежей: Инициирование платежа, перенаправление пользователя на защищенную страницу провайдера, обработка успешных и неуспешных транзакций.

Обработка вебхуков (Webhooks): Прием и валидация асинхронных уведомлений от платежных систем о статусе платежа (успех, failure, refund).

Управление подписками (Billing): Автоматическое регулярное списание средств по подпискам на тренеров или премиум-функции.

#### 1.4. Connector маркетплейса и e-commerce (Marketplace Connector)
Назначение: Обеспечить бесшовный переход от рекомендации к покупке.

Функции:

API партнерских программ: Интеграция с партнерскими сетями (например, Amazon Associates, Яндекс.Маркет Партнерская программа) для получения данных о товарах и комиссий.

Генерация глубоких ссылок (Deep Links): Создание отслеживаемых ссылок, которые ведут прямо на страницу товара в приложении или на сайте партнера.

Синхронизация данных: Кэширование актуальных данных о товарах (цена, наличие, описание) для быстрого отображения в рекомендациях.

#### 1.5. Сервис коммуникаций (Communications Service)
Назначение: Отправка пользователям транзакционных и маркетинговых уведомлений через внешние каналы.

Функции:

Email-рассылки: Интеграция с SMTP-серверами или сервисами (SendGrid, Mailchimp, UniSender) для отправки приветственных писем, напоминаний, отчетов.

SMS-уведомления: Отправка кодов подтверждения, напоминаний о тренировках через сервисы (SMS.ru, Twilio, SNS).

Push-уведомления: Интеграция с Firebase Cloud Messaging (FCM) для Android и Apple Push Notification Service (APNS) для iOS.

Шаблонизация: Создание и управление шаблонами для разных типов уведомлений.

#### 1.6. Геосервисы и карты (Geo Services & Maps)
Назначение: Обогащение приложения геоданными для мероприятий, поиска nearby активностей и трекинга.

Функции:

Картографические API: Использование Яндекс.Карт, Google Maps, MapKit или OpenStreetMap для отображения маршрутов пробежек, мест проведения мероприятий.

Геокодирование/Обратное геокодирование: Преобразование координат (широта/долгота) в читаемый адрес и обратно.

Поиск POI (Points of Interest): Поиск ближайших спортивных залов, стадионов, велодорожек.

#### 1.7. Шлюз видеотрансляций (Video Streaming Gateway)
Назначение: Обеспечить проведение онлайн-тренировок без разработки собственного видеодвижка.

Функции:

Интеграция с видеосервисами: Использование API (Zoom, Whereby, Vimeo Livestream, или специализированных Agora, Twilio Video) для создания "комнат".

Управление доступом: Предоставление ссылки на трансляцию только авторизованным пользователям, записавшимся на тренировку.

Запись и хранение: Организация записи трансляции и предоставление доступа к архиву участникам.

### 2. Ключевые сущности (Entities) и компоненты
APIIntegration (Интеграция): Конфигурация подключения к внешнему сервису (API Key, Secret, Endpoints).

WebhookEndpoint (Вебхук): URL внутри приложения, зарегистрированный у провайдера для приема уведомлений.

SyncJob (Задача синхронизации): Запись о фоновой задаче (например, "синхронизировать данные Garmin для user_id=123").

ExternalAuth (Внешняя аутентификация): Связь между UserID и идентификатором во внешней системе (например, google_id).

ThirdPartyService (Сторонний сервис): Справочник поддерживаемых систем и их метаданных.

### 3. Нефункциональные требования к модулю
Устойчивость к сбоям (Resilience): Механизмы повтора (retry) запросов при временной недоступности внешнего API.

Изоляция сбоев (Circuit Breaker): Предотвращение лавинообразных запросов к отказавшему сервису.

Безопасность: Хранение секретов (API keys, secrets) в защищенных хранилищах (HashiCorp Vault, AWS Secrets Manager), а не в коде.

Мониторинг: Логирование всех запросов и ответов, отслеживание лимитов API, алерты при проблемах с интеграциями.

Производительность: Кэширование часто запрашиваемых данных от внешних систем (например, каталог товаров).

 
